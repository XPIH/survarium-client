Предлагаю разобраться с парольной авторизацией в игре Survarium.

Далее опишу этот процесс со своей точки зрения.

Авторизация выполняется по протоколу tcp.  
Каждый пакет в первых 4 байтах данных содержит служебную информацию: код действия, номер отсылаемого пакета, номер последнего пакета, полученного от другой стороны (для клиента это будет номер последнего пакета, полученного от сервера; для сервера это будет номер клиентского пакета, для которого отсылается ответ), а также, предположительно, номер очереди сообщений. Номера пакетов нумеруются от 0 до 255 (00 - ff), и при достижении максимального номера (ff), происходит изменение номера очереди сообщений, а номер пакета становится 0.

Авторизация происходит за 4 шага, 3 из которых нужно разобрать:

1. При вводе в игре логина и пароля и нажатии на "вход", игровой клиент посылает tcp-пакет на сервер авторизации. Помимо служебной информации в первых 4х байтах, в пакете передается email, версия игрового клиента, версия рендера, а также случайное __(?)__ число из 4х байт.
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-send-email.png)
1. В ответ сервер может послать большой ответ в случае, если по логину был вход более суток назад __(?)__, либо короткий ответ в случае недавнего входа.
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-receive-salt-fat.png)
либо короткий ответ  
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-receive-salt-slim.png)
1. Клиент __шифрует__ пароль и передает его на сервер.
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-send-password.png)
1. Сервер отвечает номером сессии, который потом можно использовать для присоединении к лобби.

Примеры авторизаций (по 2 входа):  
[Длинный ответ сервера](./auth-fat.txt)  
[Короткий ответ сервера](./auth-slim.txt)

Использованный пароль: `awesomepassword`

Итого нужно понять, каким образом генерируется случайное число на шаге 1, как понимать короткий и длиные ответы сервера, и, конечно, как шифруется пароль.
