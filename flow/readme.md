Пропоную розібратися з парольною авторизацією у грі Survarium.

Далі опишу цей процес зі свого погляду.

Авторизація виконується за протоколом tcp.
Кожен пакет у перших 4 байтах даних містить службову інформацію: код дії, номер відправленого пакета, номер останнього пакета, отриманого з іншого боку (для клієнта це буде номер останнього пакета, отриманого від сервера; для сервера це буде номер клієнтського пакета, для якого надсилається відповідь), а також, ймовірно, номер черги повідомлень. Номери пакетів нумеруються від 0 до 255 (00 - ff), і при досягненні максимального номера (ff) відбувається зміна номера черги повідомлень, а номер пакета стає 0.

Авторизація відбувається за 4 кроки, 3 з яких потрібно розібрати: 

1. При введенні в грі логіну та паролю та натисканні на "вхід", ігровий клієнт посилає tcp-пакет на сервер авторизації. Крім службової інформації в перших 4-х байтах, у пакеті передається email, версія ігрового клієнта, версія рендера, а також випадкове __(?)__ число з 4х байт. 
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-send-email.png)
1. У відповідь сервер може надіслати велику відповідь у випадку, якщо за логіном був вхід більше доби тому __(?)__, або коротка відповідь у разі недавнього входу. 
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-receive-salt-fat.png)
або коротка відповідь 
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-receive-salt-slim.png)
1. Клієнт __шифрує__ пароль і передає його на сервер. 
![](https://raw.githubusercontent.com/survarium/survarium-client/master/flow/auth-send-password.png)
1. Сервер відповідає номером сесії, який потім можна використовувати для приєднання до лобі. 

Приклади авторизації (по 2 входи):  
[Довга відповідь сервера](./auth-fat.txt)  
[Коротка відповідь сервера](./auth-slim.txt)

Використаний пароль: `awesomepassword`

Загалом потрібно зрозуміти, як генерується випадкове число на кроці 1, як розуміти короткий і довгі відповіді сервера, і, звісно, як шифрується пароль.
