/**
 * Скрипт може авторизуватися по перехопленому id сесії (останнє значення AuthToLobby)
 * Авторизація можлива тільки під час життя клієнта, id сесії якого було перехоплено
 * На даний момент, скрипт тільки моніторить відповіді серверів, і не вміє посилати heartbeat пакети
*/

const BYTE = 2;

function clear (str)  {
	return str.replace(/\s/g, '');
}

function print (str)  {
	return (new Buffer(str.slice(22 * BYTE, -2 * BYTE), 'hex')).toString('utf8');
}

//console.log('message', print('15 04 78 ae 07 05 eb 47 a6 03 df de 62 6b 04 68 61 6e 61 00 01 24 53 74 72 69 6b 65 72 31 35 38 2c 20 d1 81 d0 be d1 80 d0 b8 2c d0 bd d0 b0 d0 b5 20 d1 82 d0 b5 d0 b1 d0 b5 ff ff'.replace(/\s/g, '')));

//console.log('wtf', print('160579bb09230200006134376464373663616432633066383735303933313462396330383632303961bb080e01f0000000d5adda5778a6e35701'));

//console.log('wtf', print('120378ffaf1b013b8137bd09436f7277696e5f7a7404534731330200000000b95c0927952f3609145375727272727272727272727231323334323435000200000000'));

//console.log('wtf', print('00ff042e00d08d110000ff'));

const net = require('net');
const crypto = require('crypto');

var authSample = '26 01 01 11 76 61 73 65 6b 65 72 40 67 6d 61 69 6c 2e 63 6f 6d 06 30 2e 34 34 62 32' + '027231' + '00000000' + '75c80e0f';
var authSample = '26 01 01 11 76 61 73 65 6b 65 72 40 67 6d 61 69 6c 2e 63 6f 6d 06 30 2e 34 34 62 32' + '027231' + '00000000' + '48437bdf';
var authSample = '26 01 01 11 76 61 73 65 6b 65 72 40 67 6d 61 69 6c 2e 63 6f 6d 06 30 2e 34 34 62 33' + '027231' + '00000000' + '24b8fbf0';
var authSample = '26 01 01 11 62 6f 74 40 73 75 72 76 61 72 69 75 6d 2e 70 72 6f 06 30 2e 34 34 62 33' + '027231' + '00000000' + '6c746b7b'; // bot@survarium.pro

var render = new Buffer('7231', 'hex');

const ENDIANNESS = require('os').endianness();
var email = new Buffer('vaseker@gmail.com', 'utf8');
var email = new Buffer('bot@survarium.pro', 'utf8');
const ver = new Buffer('0.44c2');

var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '434f7434', 'hex');
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '75c80e0f', 'hex');
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '48437bdf', 'hex'); // short answer
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '6c746b7b', 'hex'); // empty pass
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '6c746b7b', 'hex'); // with pass
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '6c746b7b', 'hex'); // with pass
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '6c746b7b', 'hex'); // with pass (bot)
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (bot) 27.09.2016 4:00
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + '6c746b7b', 'hex'); // with pass (bot) 27.09.2016 4:58
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (bot) 27.09.2016 5:04
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (bot) 27.09.2016 5:07
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (bot) 27.09.2016 5:10
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (vaseker) 27.09.2016 5:14
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (vaseker) 27.09.2016 5:25
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (vaseker) 27.09.2016 5:32
var Email = new Buffer('26010111' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '00000000' + 'd2fa2d97', 'hex'); // with pass (vaseker) 27.09.2016 11:45
// reconnect
// => 
new Buffer('27010112636861744073757276617269756d2e70726f06302e3434633402723100000000634d0006', 'hex'); // chat-ru (reconnect)
// <=
new Buffer('070d01ff2ee69a08', 'hex');
// =>
new Buffer('8502800000000d7e5ce240452d6d263834192b9f169973ed33f0efa4341ce34d6ed43c2bd6786681a88117de70acab1392f91276358f6dc3fe68d9db84da32ca7d7c46079596fff7b73bce886877f470a56d989b15e3635d9c8178123bfd7cbd8af5a1579245fc1be8485f43e7888ce399988f5b0a96b2a4d7a97d5bfefb207904cfea861f33', 'hex')
// <=
new Buffer('2a0e2835336532313565313533626232343331633961366263343936326533313635363232343538653063', 'hex')
new Buffer('0d0b00db511e000553ca95e9fdff', 'hex')
// reconnect to udp
// => 
new Buffer('00ff042e00db511e0000ff', 'hex');
// <=
new Buffer('000040fc', 'hex')
new Buffer('01004080000400ae6793f52cfc40200700000000b900000002000000', 'hex')
// =>
new Buffer('0101614f0119000000000000000000000000000000000000000000000000013202020100', 'hex')
// <=
new Buffer('020160ff8a03000205060000e01f6705fd5e00303a7c1803000051e3b0bdf0ff1e0bdb2239c72fdf3e85d13fc5c8280dae4930d3121e8ed04fb1cb5ef6545adbdd38e349ba976f0b46e890de0790b0abb48ba37522c339094a148d5da855bd8bdcaba603e7e12321c09462ada4e6eff172d1f0391c498a028066aca6bef6c0ef301627b937c359532f7505fa803cc2bc1539e1bb032397fe39f0df980ebb5df4ed198324275b8f67535f9ce7aa869e8056358faeb35e84c76b9762dd2c14dad1ec851e1d5d9cd12a36108c926cf985b2b091d9e448cc27d837421f8e503382c5e9e3bc469018546b4e0e14866c044cb49d42a6543ef66807fbfed3f3f53efff82b68f55fae6a2a7cfbf2832ca4da771dded2bf94002cd8073662ecc488080e91a96ccdd0b1045958cfffe94381d9e4b08609ab59202eeb530cca54863b6445283c48fe38888a7d7317085820807e031a5b80a03baba33bcff2170f06cb4b4768300567ca4aefaa7262a1882358c80d640ed17d172db59c8f1be69a8141544a7760f130555b6024880d040d539343e201d78abd4cf21e8bafdb98b9b4b19ff686ba5be1a7f1cde24e4310d98233566066d8fe176549b4a5f59e806ba9abdfe38c1b76a90650614cc80de1ee8c5199a636fd01903be4ab0be4a8e7a50d35b2624658a790ad8d3846a0276ff7acb922b2829a6190aa5560b171717a774fba4a325ae2c44c843f1c632d881353a71ea1dace24af89b7a82a540f97c69f236ef79d4e22bb0ff95e12d5ced0502990921f30d0e35d4bb195a31db394bae7ef06072f98f298d7f6c636e75ca47a26a77e4adf8b3685aa3720b645d8b9eac418ae01560902c3df4a3f3aad56b987a8fbc49935b452c1e1740280101ef71c4fb518e3c1074ec5267500e20197542c480dbc57fce7340a0371c20f4bd815e36970498314d38c0e5f281d5889113d62641db97094b88fdfdbd76e8799ae273c762b34416f03618c948101cc1fda34fbeecc7f37e542c70a63482a5a7f9de57ed164565edc53031d19f9285033d7777027a4df4069b77da2669c4b166a4c11d06ac76524ddf635a34ae6fa1e514bcc5dd2ba1d1f13d26c0aa3417f15c9d20d99abb34a0d7e5dae276bebc04df74277746861d984dff4797b8cd5ffb6576a603a58f21c048c20e4ae639de5c812be923042df097672d7df07e74cb7a41f0edfc81e864cca2d16743421ec378d2557d59267256a8bc83fd5ab41e13e8fc764a8d0594aa182767930b70c2f8ea8d9d0f5f2e1f4249994f2ff9d088345f5c7235c359ed829b0489a1d832e807b906207af46aae5350083e5ea640dae428ae7af7dbe3c440183155b71b1110df23d8e6716bc9ff436cd922afbf44faae0bde0f33d0611567465b7f4240d75dd49a2d72352b8ca8b2b07497f10d580902d98be843b3e14580305615458ffecf412b363262e39c4c37e29a249138fe7691252c8ff9dbba002ec8b285e3f45cd7ce0d9c2f4dd74803cf5f64f3c98babbc0bcce87bb5d3e129efbb6642aa3558e3d6d5a2353f18b28e4bb22fdc10625912c7f9ff31fefa5eaff905116e5c5de3f5a25ae3d37a33a6340', 'hex')
new Buffer('030161a713ff5d020051350000ab04000012646f6e746b696c6c6977616e74326c697665006f040000074d617474783132001a04000016d0a4d0b5d0bdd18fd09ed0b1d18bd187d0bdd18bd0b908d092d090d0a2d0903f0000000f4d494b4542594b4f563130333030380037000000074d6174747831320036000000077a646f6735313800130000001cd09fd0bed187d182d0b85fd091d0b5d0b75fd0a7d0b8d182d0bed0b2034e5f530f0000000f4d494b4542594b4f56313134303038000d0000000f536861646f77447261676f6e353533006f0400000642414e444f470ad091d09ed09bd0a2d0a1380400000a63616c6c756d616e646f00fc030000094d6f72636865656261054172726f77300000000642414e444f470ad091d09ed09bd0a2d0a12c0000000a63616c6c756d616e646f002a0000000d426172626172615f47686f737406534c415945521d000000094f6c4452617a5665640ad091d0bed0bbd182d18b1a000000084d6f6e306c69746800130000000948d0b5d180d0bed0bd0ad091d0bed0bbd182d18b9c040000065354d0add09f00510400000d48616e64206f66204d69646173034650473804000007526f636b43617406d09fd0a1d0983900000007662d3336392d660a5fd093d180d0b5d1855f370000000b636f756e74657232323135065341494e545a330000000a32324d696368656c32320353414d440000000a5f2d536cd0b044652d5f026e313000000007d09a6f7276696e026e31170000001453636172616d616e67612d33333236363635343100ff000000000000000000000000000000000000000000000000000000000000000000000000ffff870afffd01030000a83fbd07f047bd070000000000000000ffffffff020100030a01ff637a850000d4210000000000000100000002000000030000000400c80005000100070000000d020003010e020001010f0200000200000410000000000000000000000000cdcc4c3d666666bf01ff647a850000d4210000000000000100000002000000060000000700280005000100070000000d020003010e020001010f0200000200000410000000000000000000000000cdcc4c3d666666bf01ff657a850000d4210000000000000100000002000000080000000900500005000100070000000d020003010e020001010f0200000200000410000000000000000000000000cdcc4c3d666666bfa3dd1c04ee0240420f000000000084b8bd0700000000000000a4dd1c04ef0240420f00000000000000000000000000000000a5dd1c04f00240420f00000000006d73180000000000000000d1d51c046a0040420f0000000000ffffffff00000000000000320000003200ffffffff00000000000000420000004200ffffffff00000000000000d2d51c046b0040420f00000000005a00cb2d00000000000000680000006800ffffffff00000000000000a2dd1c045a0040420f000000000000000000000000000000005b0000005b00ffffffff00000000000000070000000700000007000000637a850001e8030000f401000006040000ba030100', 'hex') // some nicknames here
new Buffer('0401619502ffe00107000000010000000700000002003c0000000101000000003c000000000000000000000000000000180000000000000018000000000000000000010102000000010000000200960000000101000000003c000000000000000000000000000000480000000000000018000000000000000000010103000000020000000200220100000101000000003c000000000000000000000000000000a80000000000000018000000000000000000010104000000030000000200840300000101000000003c000000000000000000000000000000d00200000000000018000000000000000000010105000000040000000200c40900000101000000003c000000000000000000000000000000700800000000000018000000000000000000010106000000050000000200941100000101000000003c000000000000000000000000000000e01000000000000018000000000000000000010107000000060000000200881300000101000000003c000000000000000000000000000000382200000000000018000000000000000000010103080000001ad0a0d0b5d0bad0bed0bcd0b5d0bdd0b4d183d0b5d0bcd0bed0b500070000000cd097d0bed0bbd0bed182d0beff090000001bd09fd180d0b5d0bcd0b8d183d0bc2dd0bdd0b0d0b1d0bed180d18b00ff8a0301ffa501c239c92ef533ad87041efb74b53a356b3b4afd2598b563130ea8e2c5478bacf0e35ea01b50ac6c5ba04f39992b10d53a710ef577f8f0a5be762a304f0915855e52dc304efa9146005431470617d429919d9430512c46bff107c544e1654d50f257abe3d7d784c5f03e6c72057d3273fab48745f592e28c6e5cb15c773f03b827529fd6873c6f7457a9ff0b038309dd17395f351bfdf54a4e857bedbf6561d47e2c139c7dff1c9aa5f1c9380b27b56336b83aa3167613cf7615c0e8dc5b884f96e1176c28baebe4936473007340b488a91a9380794418ce31bd095c09646a9daaf833c916671a47980f812228a6840c4a1b0b9bd8e7624ac801733f86ffa5b230a397cdb40eccc256c54dfaa7917cfdb48824d835e74d8b6bb182d24311ce3136c19b2f09367abfda506941d51b54f3972eb46996d7e5893431d8e1a6b1d68db0cb7f018c9791bb4778d7e98aca25c277ef20e6d4b58617421c5b339b9487218d3cd8f01d5f03419494eee20acbbca1aac29d55ee9f2882ef4c7b87403421b5e9071410197bee84f97203e1efb57989f7dd97f6d244d33952c138caf32864399d1b2db553009e01ba1a68747470733a2f2f73757276617269756d2e636f6d2f73686f703e68747470733a2f2f737570706f72742e73757276617269756d2e636f6d2f696e6465782e7068703f2f72752f4b6e6f776c65646765626173652f4c6973741d68747470733a2f2f6163636f756e742e73757276617269756d2e636f6d030d39352e3231332e3136342e3832025255d2001e00010c3134392e3230322e38332e35024555a0002800020d37342e36332e3232322e313538024e412800280004a61217ff03010428030f0a0505075003140f0a080a640319140f', 'hex') // https://survarium.com/shop>https://support.survarium.com/index.php?/ru/Knowledgebase/Listhttps://account.survarium.com 95.213.164.82RU 149.202.83.5EU 74.63.222.158NA
new Buffer('0501619f11ffa1010009000100000005d600000050c30000009d0300009001000000fd03000001000000005c04000015000000005b04000001000000000200000005d600000030750000009d0300002c01000000cf03000001000000005c0400000f000000005f04000001000000000300000005d6000000204e0000009d030000fa00000000cf03000001000000005c0400000d000000006004000001000000000400000005d6000000983a0000009d030000c800000000d500000001000000005c0400000b000000006104000001000000000500000004d600000010270000009d0300009600000000d500000001000000005c04000009000000000600000003d6000000581b0000009d03000064000000005c04000007000000000700000003d600000088130000009d0300004b000000005c04000005000000000800000003d6000000b80b0000009d03000032000000005c04000003000000000900000001d6000000e8030000000a000000000109000000020800000003070000000406000000050500000006040000000703000000080200000009010000000a04ff06002852000000000000940eb602000000896f4f000000000000000000780500000a000000000000000000000018028c6f4f008f1c0200000000000000000000000000000000000000000000010000000000001b00000017000000360000003700000038000000390000003a0000003000000031000000320000003300000034000000350000005500000056000000580000005900000065000000660000008b000000430100004201000041010000400100003f0100003e0100003d0100003c0100009208ab070000000000000000000000000100000000000000000000000200000000000000000000000300000000000000f4010000040000000000000000000000050000000000000000000000060000000000000000000000030300000092833d00100000000000000000000000000000000100000093833d00120000000000000000000000000000000100000094833d000c00000000000000000000000000000001000000000000000000000000b7108c0100000200000300000400000500000600000700000800000900000a00000b00000c00000d00000e00000f00001000001100001200001300001400001500001600001700001800001900001a00001b00001c00001d00001e00001f00002000002100002200002300002400002500002600002700002800002900002a00002b00002c00002d00002e0000000089095a0b00000052000000e000fa004a5e0067b53f80408fdc9ee1600c0cd4cbe70b277ae3205cd588f69b227f5b21647203dd206f901413cedef14ec87686fb3d377d3ccedd29e1c6b9c8d8e7fa7af54b37b5d8d5c9e2d40ac6ac000083153e550208000000910100000000009501000000000098010101000000990100000000009a0100000000009b0100000000009c0100000000009d0100010000008c0d1101e8030000f40100000604000001ca00018b0b10ac0d0000000000000000000000000000aa14050000000000', 'hex')
new Buffer('0601619b0434000048420000c84290019001e803d007a00f7017401f1027e02e803e204e0200020005000a0014001e00280032003c00500064008d00347102000002000000a0860100fa000000fa00000090d00300320000009a99193e0000003f0000803f0000a03f0000c03f000000408f0510000e73757276617269756d2d63686174ab0ea086010003015a000246000425009d060aff920100000100000003a00707000000000000008317065501000000008316065503010405009a020500000000009c010405050805af0f03060000960c010f', 'hex') // player info (survarium-chat)
// =>
new Buffer('02067855030000000000', 'hex')
// <=
new Buffer('070160851800', 'hex')
new Buffer('08027083195500', 'hex')
new Buffer('', 'hex')

var Email = new Buffer(clear('26 01 01 11' + email.toString('hex') + '06' + ver.toString('hex') + '02' + render.toString('hex') + '000000' + '00 8f 98 25 15'), 'hex');

var EmailRes = new Buffer(clear('07 0d 01 ff f4 71 2e b1'), 'hex');

var PassCrypt = crypto
	.createHmac('sha512', 
		new Buffer(clear('f4 71 2e b1' + '00 8f 98 25 15'), 'hex'))
    .update(new Buffer('awesomepassword', 'utf8'));

//850280000000 a09ff8cda753cce0b62fe716a8e3dc893117802ad88289bb1ae317b692c9821a54c07073aae0b7e7af3e2eaa5b9bab9e956cb8abb00239dcab429e2167ab6d23ddf57ca21c6a82fb1d5e74d31ab4f27269648b3d205841c6cbf56b8bdf8cbc8549e6c60ab087c448e3ca7b5936e513fc5691d6d078c01e73bb6e33be11397621

var ResSalt = clear('07 0d 01 ff' + 'de e8 20 d6');
var ResSalt = clear('07 0d 01 ff' + '0f 9c 2f 74');
var ResSalt = clear('07 0d 01 ff' + '8a c1 7e 31');
var ResSalt = clear('07 0d 01 ff' + 'f8 b9 0d ff'); // empty pass
var ResSalt = clear('07 0d 01 ff' + 'f3 2e 09 29'); // with pass
var ResSalt = clear('07 0d 01 ff' + '3b e2 cc 97'); // with pass
var ResSalt = clear('07 0d 01 ff' + '04 ad 58 60'); // with pass (bot)
var ResSalt = clear('07 0d 01 ff' + '35 e2 28 4d'); // with pass (bot) 27.09.2016 4:00
var ResSalt = clear('07 0d 01 ff' + 'dc bc 97 2e'); // with pass (bot) 27.09.2016 4:48
var ResSalt = clear('07 0d 01 ff' + 'c1 11 4f 94'); // with pass (bot) 27.09.2016 5:04
var ResSalt = clear('07 0d 01 ff' + 'f8 a9 be 61'); // with pass (bot) 27.09.2016 5:07
var ResSalt = clear('07 0d 01 ff' + '24 3f 7d 1a'); // with pass (bot) 27.09.2016 5:10
var ResSalt = clear('07 0d 01 ff' + 'fa 5d a2 9b'); // with pass (vaseker) 27.09.2016 5:14
var ResSalt = clear('07 0d 01 ff' + '51 d1 bf c1'); // with pass (vaseker) 27.09.2016 5:25
var ResSalt = clear('07 0d 01 ff' + '97 5a e0 aa'); // with pass (vaseker) 27.09.2016 5:32

var EmailRes = clear('97 0d 01 00 8c 00 00 00 30 81 89 02 81 81 00 b5 a0 5e 37 c1 5d 58 51 ac ef 98 01 1e 07 6d 37 f5 31 8d f3 d9 6f 23 94 7b d9 72 20 e3 61 1e 88 9f 32 f7 b8 da be 2d ab 81 87 00 d1 2a 04 44 0e 51 0f 68 77 3d 5a 80 a4 9d 16 d0 30 de b1 bc 68 cc d0 f9 8e ae 32 d2 59 e7 34 96 23 c6 8b c9 04 23 22 04 90 b3 83 a9 2a 28 cc 25 e5 1d e9 6c 35 4a 15 0c 01 ff 20 0e 83 c1 e9 a9 7a e7 14 bf aa 26 9f 8a eb e0 bf 93 b4 f2 69 ab a2 5f 9c 5c c5 02 03 01 00 01 21 b1 e4 44'); // appears sometime

var EmailRes = clear('970d01008c00000030818902818100b9285227a4dd817269e9e959a79996fbbb81dd013b850e444466861f6ff26d49582799db16c1646104e11c673a509a61f79a9522582532d69889a0b4b498fe710d3cc2faa974d53f68a45983decee5a7d9567e6b0d7ed32adc53cd49a347445f722bd51d94bb766fb193fb3412fbb3df84ebb2f0286eae13ae2ddf40ca21a01302030100012c50bb36'); // bot 27.09.2016 11:45

var EmailRes = clear('970d01008c00000030818902818100a90d4c1eb6a21b9460bd19faa3af11128aacac2a0a848248f736d4f7261155b0c4fcecd0960e9e0cfb59d33b718a4d8011bb4dc472894dc3eaecccec4b98f492fc87a355b23498438230ef1f81a9934f2a1c165380485af851dafcaf95dda8cf345a9021b9ebbe3dbeb248929452ea4f06dd3ea917e58c897eb5c15f61d6d32d0203010001824c4bff'); // vaseker 27.09.2016 4:58

//console.log(( new Buffer(EmailRes, 'hex') ).toString('utf8'));

var Pass = clear('85 02 80 00 00 00 5d 13 6f 36 a7 15 04 8c 94 b2 da 5d f8 4a 2f ab 43 3a dd 1a 1d 37 2d f7 f0 f9 87 c9 b2 09 b6 3e 1f cb 5f a3 00 ba dc da 1f 67 af 72 39 43 72 97 cd e2 a6 b3 cd aa aa e5 5c 62 58 37 70 2d 97 0d 5f 8d 3d d3 4d 66 7b 02 9e 0f dd 64 10 1d 45 e1 47 e8 a4 90 90 4d b7 ab 8c 79 c6 4e f9 bd 88 7b 19 e2 b1 cf dd 18 5c 7d 9f d6 35 52 32 ef 2c 88 6c c3 3d 0f e9 f3 1c e6 71 aa 92 39 aa 45 94 a4');

var Pass = clear('85 02 80 00 00 00 05 87 d5 49 73 12 bf 1d 5e 7d ce 29 95 e7 7f f9 e1 ed 02 4e 27 45 8f 12 6a d3 d5 92 e0 7c dd da 31 6a cb 48 90 cb 7a 9e bf 5a a9 54 e5 86 19 0f a4 d8 b8 bb 47 bf ee d4 56 68 d6 52 78 29 85 42 70 c2 be 75 8b c8 76 24 10 51 03 5d 45 6c 90 6c 2e 27 3a 61 ad cf 81 1c c1 ab 98 f6 75 db dd 22 a3 f5 f5 9c a3 7a 83 10 98 81 47 49 e2 94 a1 d0 a3 81 13 34 28 dc ce 59 25 1a 72 14 b3 c2 51 b3');

var Pass = clear('85 02 80 00 00 00 12 f5 06 82 08 dc 26 af 07 9b 05 cc 5f d3 11 43 79 0c df 6f a2 30 40 38 e9 e5 93 a4 76 e9 3c e8 89 34 e0 8e 8d 1c b2 92 f9 6e ce 2a 7b a5 91 27 e0 c4 9f 1f 2a 54 a3 1c 51 38 d0 3f 3c de 04 e6 e2 f9 a1 51 53 b1 42 bd 56 33 3e 10 49 56 40 58 30 84 d4 4c 5e 37 e7 eb 4b b9 97 6d 1e 40 ab e6 43 1d ea 13 b2 b9 3e 84 a9 ee 3e 11 d6 28 15 a9 a3 ac ed 56 3f 2a 65 df 6b b5 8d 0b ac ef f4 5a'); // empty pass

var Pass = clear('85 02 80 00 00 00 54 8d bd 84 0f c6 4b 34 ac 34 60 13 fe 07 b6 45 b6 5a 7d d3 ce 58 2f f1 0b 8d ac 7c a0 32 0d 5c 25 89 c5 fc 29 a7 db 3a c9 3b 54 be 72 94 28 f5 75 ff 0f 0d 33 0b 25 99 3e 44 1e 35 f5 ab ad 83 44 fe e8 b5 2c f8 0a 67 97 3b b2 9f 36 33 35 6d c0 19 89 86 b8 e3 ef f0 44 a7 76 e1 1a 6c 58 18 1e a9 77 5f 69 cd 56 c9 b8 67 2d 54 1e 1c 98 6c 43 34 eb ca 6a 26 51 fe 19 18 fc ab 61 59 79 e0'); // with pass

var Pass = clear('85 02 80 00 00 00 53 a2 0d 52 af 1d 26 d4 ee 7d 17 64 75 5b 60 8b d6 67 5d 10 8b 4e 5a ed 8e 48 71 05 60 8a c8 e8 bf c7 95 18 8d b7 08 b0 22 56 40 cf 70 5b 00 97 f7 31 90 b3 38 1a eb e8 00 65 c0 c2 4b 77 26 a4 e8 91 1c 4a 47 e3 41 cc e5 8f 48 a0 81 05 a3 87 b3 84 60 49 56 54 a8 f0 7c dd de 10 5b 99 ab 9b 52 dc dd 0d a4 d8 23 4a 12 fb 80 8c df 33 91 fa 60 f6 eb c5 4a 8e 22 19 58 fe a5 ec c0 93 1a 60'); // with pass

var Pass = clear('85 02 80 00 00 00 1e 18 34 55 40 e2 50 5b f5 bc 65 37 39 b4 57 8b fe 3d 90 22 f7 f9 d7 ce bd d3 9d 6a e1 b6 1e fd db 46 3c d5 61 bf 7f d2 1f c9 ea 20 80 f3 49 f8 e8 a2 c6 87 60 6b d9 98 a6 5a f0 61 ef 96 c4 11 aa d5 8b dc f2 45 82 dd cc 4e e0 c7 57 4c f6 9b 61 a4 92 1f 40 26 ed 16 ae 8c d9 5f 6c e5 a0 24 30 2f 39 ea d2 a9 fe 3b 2f 69 1b 6c 0d 76 31 5e 22 64 4e 5f dd a6 68 40 ae 1e d8 95 2d 13 73 ff'); // with pass (bot)

var Pass = clear('85 02 80 00 00 00 52 3e e8 bb b7 ea 54 e9 3d 7b 8f 03 5a e6 ca d1 c7 fe 1c e3 1e cf a7 b3 8c 8f 3b 81 af e0 a2 0f 1d 71 63 07 d4 70 7c 59 e8 73 df 87 0f 7a 1a 5a d5 c4 23 6e fb 72 dc b2 fd b6 4e 63 ff b5 05 4f d1 03 ec 1f 69 50 f1 8f 57 3d 9b 5a 75 84 cd 8b e9 31 ca 50 d6 16 d7 13 2b e0 dd 07 71 76 67 02 77 f6 d7 e6 e0 3a 78 a6 a3 8d ce 9b da b5 b0 ab cd e0 62 64 47 5e 52 94 4c f0 96 45 6d 3d fd 41'); // with pass (bot) 4:48

var Pass = clear('85028000000037187271ae76ae8b3f5d5568972fd940ec37d80c06bf00d9dca6bd540cac43e845cfac9c05142903af11ccdd5cc65e2905f6306dee019b89a2544c8ad7439e69b520d9f958d87f76b7cdc465ee1bc2db6ad53769164eeb288dd91443da4f41c7894ef457a6e37b2ecc7de17326fdd7bbe499411861d1eaaff45eeca305a46b4d'); // with pass (bot) 4:58

var Pass = clear('8502800000007dff2e109b5a01e886e42e0fb3ff6984480487dbbe6609b8d944b67c0369a36a664bf69cde86502716b3e26757636e0f7e1df75f16385fa22417a7f63c16b7830b9a55e3122a2777d8d028c50da22ed72c664611ee3f85e1d350dc2ef9520777e9e66737a637841636f77b1a8539d32e0cb928bc7f06533b58c70b95813d5bca'); // with pass (bot) 5:04

var Pass = clear('8502800000006d0604e53e933e6379671926a56751a0a20dbb8112bca3249b4bbdc4cdda8abb8b184e9b8de8ebf611e97d6980bc261669ac2bbb13cad886e61e7ca7909f9ed0fb4798ed5ec4d4b830536db5421549053b9729b6bd85d590d1eeca094d16586ea8a41c0552c395f72ca28e574819cf825e86d9d676c00688dce490034157d356'); // with pass (bot) 5:07

var Pass = clear('8502800000003eefccabe1f6a25fd8c4153ca814d2bc55062418d3ee7cee1c9e428521e3e86cc8b7334417f8853e132729462769ae3085f89263f25650d11805cc1eca9922ac8c1e9d8ac5263e85150da3d5c38780169ab94273bfd1b00b850a6db2b07e671bee4e32d8fa114a08acfb1d475a2dd66dc1f3d1d3e9c54477fb8a8c28505e73c8'); // with pass (bot) 5:10

var Pass = clear('850280000000904ba854381da3816824c4ed5a1558bf0e204cb59d03b570998437f0fe7f16f69debe6c76099eb83dbac4df5dcec67e295476b51d75129ae1fff2b4b545172e437b22a7512029bc6359d8747e98cffcc0ee2ea0f3d4306e068201632e5c4a3d2cc48520fe35e506e9ea9923462a69f0c746f00ed5aa1d23d73771a825f44148b'); // with pass (vaseker) 5:14

var Pass = clear('850280000000a9107f7efd9b33d268c2cfd906d87ec5810d786c1a68a23f7e440650b6b2cc594e8de1151a7d0e1319dcc332919576f28a55111595e5ce8b3e78db634dcf0f8c578a45da65f91dce432130b5a301b41469149814d052469e3002ace695c8fa225924542f564dfe4671b35d885db78b7a3aa8af524ff5ae053b82747a3093d884'); // with pass (vaseker) 5:25

var Pass = clear('850280000000573be431650959da07f1ba403de23e476b7615558294c173418c2de6c267479245b0dc1934a31f471373ad64ad1441f8c40341ff1bdf382ba3231c3397169f7e14228dc2a14e6b61388d568f3f30c38dbbf003890acf6b9ee4c325bdcc2b8f46b3e6d0147c7a15fe80a85534e242659b132ef7fc70a2dae927894fdc5730ac51'); // with pass (vaseker) 5:32

var Pass = clear('8502800000006d77cb2b3abf36c790b2d2ac9517656cc080e1d9ec941897485660993a72f2bd42e5ebc846a8ff5b000466475a85b8eed7bb759dd5ce2d9cb18095a4ae46ca8436744d5abd58b3da40af37561fc3f20d3cd318a6e6273fcc87a8bef39bd32dd05ce0777c3f74124eb8227a0b9156a11df29b3fa18c607c889f3e3b322263036c'); // with pass (vaseker) 11:45

var Auth1 = '2a 0e 28 39 39 31 31 61 62 66 30 30 63 66 65 34 61 61 37 65 31 36 64 66 66 39 66 32 64 66 66 64 64 65 31 32 31 34 63 31 31 66 61';
var Auth2 =             '0d 0b 00 61 9f 13 00 05 53 ca 95 e9 fd ff';

var Auth1 = '02 0c 04 00 00 00'; // empty pass

var Auth1 = '2a 0e 28 39 39 31 31 61 62 66 30 30 63 66 65 34 61 61 37 65 31 36 64 66 66 39 66 32 64 66 66 64 64 65 31 32 31 34 63 31 31 66 61';
var Auth2 =             '0d 0b 00 1b a4 13 00 05 53 ca 95 e9 fd ff';
var AuthToLobby = '00 ff 04 2e 00 1b a4 13 00 ff ff';

var Auth1 = '2a 0e 28 39 39 31 31 61 62 66 30 30 63 66 65 34 61 61 37 65 31 36 64 66 66 39 66 32 64 66 66 64 64 65 31 32 31 34 63 31 31 66 61';
var Auth2 =                 '0d 0b 00 56 a5 13 00 05 53 ca 95 e9 fd ff';
var Auth2 =                 '0d 0b 00 a5 fa 1d 00 05 53 ca 95 e9 fd ff';
var AuthToLobby = '00 ff 04 2e 00' + '56 a5' +  '13 00 ff ff';

var Auth1 = '2a 0e 28 39 30 61 39 38 37 64 65 34 61 34 65 63 37 31 30 39 36 63 63 34 66 33 33 62 38 63 62 66 39 34 32 66 30 35 34 38 62 35 36'; //bot
var Auth2 =                 '0d 0b 00 42 ac 13 00 05 53 ca 95 e9 fd ff'; //bot

var Auth1 = '2a 0e 28 39 30 61 39 38 37 64 65 34 61 34 65 63 37 31 30 39 36 63 63 34 66 33 33 62 38 63 62 66 39 34 32 66 30 35 34 38 62 35 36'; // bot 4:48
var Auth2 =                 '0d 0b 00 b2 b7 13 00 05 53 ca 95 e9 fd ff'; // bot 4:48

var Auth1 = '2a0e2839306139383764653461346563373130393663633466333362386362663934326630353438623536'; // (bot) 4:58
var Auth2 =                 '0d0b00f1b713000553ca95e9fdff'; // bot 4:58

var Auth1 = '2a0e2839306139383764653461346563373130393663633466333362386362663934326630353438623536'; // (bot) 5:04
var Auth2 =                 '0d0b001cb813000553ca95e9fdff'; // bot 5:04

var Auth1 = '2a0e2839306139383764653461346563373130393663633466333362386362663934326630353438623536'; // (bot) 5:07
var Auth2 =                 '0d0b0037b813000553ca95e9fdff'; // bot 5:07

var Auth1 = '2a0e2839306139383764653461346563373130393663633466333362386362663934326630353438623536'; // (vaseker) 5:10
var Auth2 =                 '0d0b004cb813000553ca95e9fdff'; // vaseker 5:10

var Auth1 = '2a0e2839393131616266303063666534616137653136646666396632646666646465313231346331316661'; // (vaseker) 5:14
var Auth2 =                 '0d0b0062b813000553ca95e9fdff'; // vaseker 5:14

var Auth1 = '2a0e2839393131616266303063666534616137653136646666396632646666646465313231346331316661'; // (vaseker) 5:25
var Auth2 =                 '0d0b00abb813000553ca95e9fdff'; // vaseker 5:25

var Auth1 = '2a0e2839393131616266303063666534616137653136646666396632646666646465313231346331316661'; // (vaseker) 5:32
var Auth2 =                 '0d0b00dbb813000553ca95e9fdff'; // vaseker 5:32

var Auth1 = '2a0e2839393131616266303063666534616137653136646666396632646666646465313231346331316661'; // (vaseker) 11:45
var Auth2 =                 '0d0b0014c513000553ca95e9fdff'; // vaseker 11:45

var AuthToLobby = '00 ff 04 2e 00' +  '3b a8' + '13 00 ff ff';
var AuthToLobby = '00 ff 04 2e 00' +  '87 a9' + '13 00 ff ff';
var AuthToLobby = '00 ff 04 2e 00' +  '7f aa' + '13 00 ff ff';
var AuthToLobby = '00 ff 04 2e 00' +  'a3 ab' + '13 00 ff ff';
var AuthToLobby = '00 ff 04 2e 00' +  '42 ac' + '13 00 ff ff'; //bot
var AuthToLobby = '00 ff 04 2e 00' +  '56 a5' + '13 00 ff ff'; //bot 4:48
var AuthToLobby = '00 ff 04 2e 00' +  'f1 b7' + '13 00 ff ff'; //bot 4:58
var AuthToLobby = '00 ff 04 2e 00' +  '1c b8' + '13 00 ff ff'; //bot 5:04
var AuthToLobby = '00 ff 04 2e 00' +  '37 b8' + '13 00 ff ff'; //bot 5:07
var AuthToLobby = '00 ff 04 2e 00' +  '4c b8' + '13 00 ff ff'; //vaseker 5:10
var AuthToLobby = '00 ff 04 2e 00' +  '62 b8' + '13 00 ff ff'; //vaseker 5:14
var AuthToLobby = '00 ff 04 2e 00' +  'ab b8' + '13 00 ff ff'; //vaseker 5:25
var AuthToLobby = '00 ff 04 2e 00' +  'db b8' + '13 00 ff ff'; //vaseker 5:32
var AuthToLobby = '00 ff 04 2e 00' +  '14 c5' + '13 00 ff ff'; //vaseker 11:45
var AuthToLobby = '00 ff 04 2e 00      ff c5     13 00 ff ff'; //vaseker 12:00
var AuthToLobby = '00 ff 04 2e 00      82 c6     13 00 ff ff'; //vaseker 12:10
var AuthToLobby = '00 ff 04 2e 00      d2 c6     13 00 ff ff'; //vaseker 12:14
var AuthToLobby = '00 ff 04 2e 01      d2 c6     13 00 ff ff'; //vaseker 12:14
var AuthToLobby = '00 ff 04 2e 00 	   13 9e     1d 00 ff ff'; //chat-en
var AuthToLobby = '00 ff 04 2e 00      1d 4f     1d 00 ff ff'; //vaseker-steam-ru
var AuthToLobby = '00 ff 04 2e 00      a4 f8     1d 00 ff ff'; //chat-en
var AuthToLobby = '00 ff 04 2e 00      eb f8     1d 00 ff ff'; //chat-ru
var AuthToLobby = '00 ff 04 2e 00      48 fa     1d 00 ff ff'; //chat-ru
var AuthToLobby = '00 ff 04 2e 00      a5 fa     1d 00 ff ff'; //chat-ru
var AuthToLobby = '00 ff 04 2e 00      0b fc     1d 00 ff ff'; //chat-ru
var AuthToLobby = '00 ff 04 2e' +  '00 39 50 1e' + '00 ff ff'; //chat-ru
var AuthToLobby = '00ff042e         00 7d 51 1e     00 ff ff'; //chat-ru
'00004080000400ae6793f52cfc40200700000000b900000002000000'
'00004080000400ae6793f52cfc40200700000000b900000002000000'

var AskSome1 = '0100414f0119000000000000000000000000000000000000000000000000013202020100';
var AskSome1 = '0100414f0119000000000000000000000000000000000000000000000000013202020100';
console.log(0x13202020100.toString(10));
console.log(new Date(Number(0x13202020100.toString(10))));

//['56a5', 'f1b7', '1cb8', '37b8', '4cb8', '62b8', 'abb8', 'dbb8', '14c5', 'ffc5', '82c6', '2256a5'].forEach(id => console.log( ( new Buffer(id, 'hex') ).readUInt16LE() ));

var plannedTimeout;
function planTimeout () {
	clearTimeout(plannedTimeout);
	plannedTimeout = setTimeout(() => {
		console.log('timeout reached');
		socket.close();
	}, 5000);
}

const CONNECT_OK = 0x000040fc;

// >
// fe667efc
// <
// ffff04fd
// >
// ff667efc
// 00667cfc
// < 
// 01ff04fd
// > 
// 

var reqNum = 0;

function askForChat() {

}

function messageParser (buffer, remote) {
	console.log((new Array(20)).join('_'));

	var resNum = buffer.readUInt8(0);
	reqNum = buffer.readUInt8(1);

  	console.log('Received %d bytes from %s:%d\n', msg.length, remote.address, remote.port);
  	console.log(msg);


  	console.log(print(msg.toString('utf8')));
}

var reAuth;
const dgram = require('dgram');
const socket = dgram
	.createSocket('udp4')
	.on('message', messageParser)
	.on('error', err => {
		console.error(err);
	})
	.on('close', () => {
		console.log('close');
	})
	.on('listening', () => {
		console.log('listening');
	});

function send(buffer, cb) {
	socket.send(buffer, 0, buffer.length, 65001, 'game.survarium.com', cb);
}

function attachSession() {
	var auth = new Buffer(clear(AuthToLobby), 'hex');
	send(auth, () =>  console.log('auth sent'));
}

function start () {
	attachSession();
};


function unknown () {
	'01 00 41 50 01 19 3a 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 32 02 02 01 00';
	'01 00 41 50 01 19 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 32 02 02 02 00'; //en
	'01 00 41 50 01 19 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 32 02 02 01 00'; //ru
}

setTimeout(() => { start() }, 500);

//console.log(crypto.getHashes());

// const hash = crypto.createHmac('sha512', new Buffer(clear(ResSalt), 'hex'))
//                    .update('awesome');

// console.log('pass1', hash.digest('hex'));
/*
console.log('pass-check', {
	length: Pass.length,
	data: ( new Buffer(Pass, 'utf8') ).toString('utf8')
});
*/
//65001 – lobby

/*
const client = net
	.connect(65000, 'game.survarium.com', (err) => {
		if (err) {
			console.error(err);
		}
		console.log(`connected to ${client.remoteAddress}:${client.remotePort}`);
		console.log(Email);
		client.write(Email);
	})
	.on('data', (data) => {
	  console.log(data.toString('hex'));
	})
	.on('end', () => {
	  console.log('disconnected from server');
	})
	.on('error', (err) => {
		console.log('got error');
		console.error(err);
	});
*/
